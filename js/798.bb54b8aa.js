"use strict";(self["webpackChunksopimem"]=self["webpackChunksopimem"]||[]).push([[798],{1798:function(e,a,l){l.r(a),l.d(a,{default:function(){return De}});var t=l(6252),n=l(3577),o=l(9963);const r={class:"stepsdemo-content"},d=(0,t.Uk)("Etat de la facture"),i={class:"p-fluid grid"},u={class:"field col-12 lg:col-6 md:col-6 sm:col-6"},c={class:"p-float-label"},s=(0,t.Uk)(" Numéro de la facture ("),p=(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* ",-1),m=(0,t.Uk)(") "),v=[s,p,m],_={key:0,class:"p-error"},$={class:"field col-12 lg:col-6 md:col-6 sm:col-6"},f={class:"p-float-label"},h=(0,t.Uk)(" Montant Réel ("),g=(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* ",-1),x=(0,t.Uk)(") "),T=[h,g,x],b={key:2,class:"p-error"},A={class:"field col-12 lg:col-6 md:col-6 sm:col-6"},C={class:"p-float-label"},y=(0,t.Uk)(" T.V.A ("),w=(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* ",-1),V=(0,t.Uk)(") "),k=[y,w,V],H={key:0,class:"p-error"},D={class:"field col-12 lg:col-6 md:col-6 sm:col-6"},U={class:"p-float-label"},F=(0,t.Uk)(" Montant de HT ("),I=(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* ",-1),B=(0,t.Uk)(") "),q=[F,I,B],S={key:0,class:"p-error"},W={class:"field col-12 lg:col-6 md:col-6 sm:col-6"},O={class:"p-float-label"},z=(0,t.Uk)(" Montant de TTC ("),R=(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* ",-1),N=(0,t.Uk)(") "),P=[z,R,N],M={key:0,class:"p-error"},Z={class:"field col-12 lg:col-6 md:col-6 sm:col-6"},j={class:"p-float-label"},E=(0,t.Uk)(" Contrat Du ("),L=(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* ",-1),Y=(0,t.Uk)(") "),G=[E,L,Y],K={key:0,class:"p-error"},X=(0,t.Uk)("Vendre Par Tranche"),J={class:"field col-12 lg:col-6 md:col-6 sm:col-6"},Q={class:"p-float-label"},ee=(0,t.Uk)(" Vendre par tranche ? ("),ae=(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* ",-1),le=(0,t.Uk)(") "),te=[ee,ae,le],ne={key:0,class:"p-error"},oe={class:"field col-12 lg:col-6 md:col-6 sm:col-6"},re=(0,t.Uk)("Nbr Tranche ("),de=(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* ",-1),ie=(0,t.Uk)(") "),ue=[re,de,ie],ce={key:0,class:"p-error"},se={class:"p-tag"},pe={class:"field col-12 lg:col-4 md:col-6 sm:col-6"},me={class:"p-float-label"},ve=(0,t._)("label",{for:"taux_tranche"},[(0,t.Uk)("Taux de la tranche("),(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* "),(0,t.Uk)(") ")],-1),_e={class:"field col-12 lg:col-4 md:col-6 sm:col-6"},$e={class:"p-float-label"},fe=(0,t._)("label",{for:"prix_prevue"},[(0,t.Uk)("Montant prevus ("),(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* "),(0,t.Uk)(") ")],-1),he={class:"field col-12 lg:col-4 md:col-6 sm:col-6"},ge={class:"p-float-label"},xe=(0,t._)("label",{for:"prochaine_rdv_prevue"},[(0,t.Uk)("Prochaine Rendez-vous Prévue ("),(0,t._)("i",{class:"text-red-400 font-large",style:{"font-size":"18px"}},"* "),(0,t.Uk)(") ")],-1),Te={class:"grid grid-nogutter justify-content-between"};function be(e,a,l,s,p,m){const h=(0,t.up)("Divider"),g=(0,t.up)("InputMask"),x=(0,t.up)("InputNumber"),y=(0,t.up)("Dropdown"),w=(0,t.up)("Calendar"),V=(0,t.up)("Button"),F=(0,t.up)("Card");return(0,t.wg)(),(0,t.iD)("div",r,[(0,t.Wm)(F,null,{title:(0,t.w5)((()=>[(0,t.Wm)(h,{align:"center",type:"dotted"},{default:(0,t.w5)((()=>[d])),_:1})])),content:(0,t.w5)((()=>[(0,t._)("div",i,[(0,t._)("div",u,[(0,t._)("span",c,[(0,t.Wm)(g,{disabled:"",class:(0,n.C_)({"p-invalid":s.vAdd$.num_facture.$invalid&&s.submitted}),id:"nom",mask:s.vAdd$.num_facture.$model,value:s.vAdd$.num_facture.$model,modelValue:s.vAdd$.num_facture.$model,"onUpdate:modelValue":a[0]||(a[0]=e=>s.vAdd$.num_facture.$model=e),placeholder:"N°Facture AP-99-999"},null,8,["class","mask","value","modelValue"]),(0,t._)("label",{for:"montant_reel",class:(0,n.C_)({"p-error":s.vAdd$.num_facture.$invalid&&s.submitted})},v,2),s.vAdd$.num_facture.$invalid&&s.submitted||s.vAdd$.num_facture.$pending.$response?((0,t.wg)(),(0,t.iD)("small",_,"ce champ est obligatoire")):(0,t.kq)("",!0)])]),(0,t._)("div",$,[(0,t._)("span",f,[s.MotantUpdated?((0,t.wg)(),(0,t.j4)(x,{key:0,id:"montant_reel",showButtons:"",incrementButtonIcon:"pi pi-plus",min:0,decrementButtonIcon:"pi pi-minus",decrementButtonClass:"p-button-danger",incrementButtonClass:"p-button-success",modelValue:s.vAdd$.montant_reel.$model,"onUpdate:modelValue":a[1]||(a[1]=e=>s.vAdd$.montant_reel.$model=e),mode:"currency",currency:"DZD",class:(0,n.C_)({"p-invalid":s.vAdd$.montant_reel.$invalid&&s.submitted})},null,8,["modelValue","class"])):((0,t.wg)(),(0,t.j4)(x,{key:1,id:"montant_reel",onClick:a[2]||(a[2]=e=>s.changeMontantReel(!0)),showButtons:"",incrementButtonIcon:"pi pi-plus",min:0,decrementButtonIcon:"pi pi-minus",decrementButtonClass:"p-button-danger",incrementButtonClass:"p-button-success",modelValue:s.motantReelupdated,"onUpdate:modelValue":a[3]||(a[3]=e=>s.motantReelupdated=e),mode:"currency",currency:"DZD",class:(0,n.C_)({"p-invalid":s.vAdd$.montant_reel.$invalid&&s.submitted})},null,8,["modelValue","class"])),(0,t._)("label",{for:"montant_reel",class:(0,n.C_)({"p-error":s.vAdd$.montant_reel.$invalid&&s.submitted})},T,2),s.vAdd$.montant_reel.$invalid&&s.submitted||s.vAdd$.montant_reel.$pending.$response?((0,t.wg)(),(0,t.iD)("small",b,"ce champ est obligatoire")):(0,t.kq)("",!0)])]),(0,t._)("div",A,[(0,t._)("span",C,[(0,t.Wm)(y,{id:"tva",modelValue:s.vAdd$.TVA.$model,"onUpdate:modelValue":a[4]||(a[4]=e=>s.vAdd$.TVA.$model=e),options:s.classTva,optionLabel:"label",optionValue:"value"},null,8,["modelValue","options"]),(0,t._)("label",{for:"tva",class:(0,n.C_)({"p-error":s.vAdd$.TVA.$invalid&&s.submitted})},k,2),s.vAdd$.TVA.$invalid&&s.submitted||s.vAdd$.TVA.$pending.$response?((0,t.wg)(),(0,t.iD)("small",H,"ce champ est obligatoire")):(0,t.kq)("",!0)])]),(0,t._)("div",D,[(0,t._)("span",U,[(0,t.Wm)(x,{id:"prix_HT",showButtons:"",incrementButtonIcon:"pi pi-plus",min:0,decrementButtonIcon:"pi pi-minus",decrementButtonClass:"p-button-danger",incrementButtonClass:"p-button-success",modelValue:s.vAdd$.prix_HT.$model,"onUpdate:modelValue":a[5]||(a[5]=e=>s.vAdd$.prix_HT.$model=e),mode:"currency",currency:"DZD",class:(0,n.C_)({"p-invalid":s.vAdd$.prix_HT.$invalid&&s.submitted})},null,8,["modelValue","class"]),(0,t._)("label",{for:"prix_HT",class:(0,n.C_)({"p-error":s.vAdd$.prix_HT.$invalid&&s.submitted})},q,2),s.vAdd$.prix_HT.$invalid&&s.submitted||s.vAdd$.prix_HT.$pending.$response?((0,t.wg)(),(0,t.iD)("small",S,"ce champ est obligatoire")):(0,t.kq)("",!0)])]),(0,t._)("div",W,[(0,t._)("span",O,[(0,t.Wm)(x,{readonly:"",disabled:"",id:"prix_TTC",incrementButtonIcon:"pi pi-plus",min:0,suffix:" DZD","model-value":s.vAdd$.prix_TTC.$model?parseFloat(s.vAdd$.prix_TTC.$model):0,class:(0,n.C_)({"p-invalid":s.vAdd$.prix_TTC.$invalid&&s.submitted})},null,8,["model-value","class"]),(0,t._)("label",{for:"prix_TTC",class:(0,n.C_)({"p-error":s.vAdd$.prix_TTC.$invalid&&s.submitted})},P,2),s.vAdd$.prix_TTC.$invalid&&s.submitted||s.vAdd$.prix_TTC.$pending.$response?((0,t.wg)(),(0,t.iD)("small",M,"ce champ est obligatoire")):(0,t.kq)("",!0)])]),(0,t._)("div",Z,[(0,t._)("span",j,[(0,t.Wm)(w,{modelValue:s.vAdd$.contrat_du.$model,"onUpdate:modelValue":a[6]||(a[6]=e=>s.vAdd$.contrat_du.$model=e),id:"contrat_du",showIcon:!0,dateFormat:"dd/mm/yy",class:(0,n.C_)({"p-invalid":s.vAdd$.contrat_du.$invalid&&s.submitted})},null,8,["modelValue","class"]),(0,t._)("label",{for:"contrat_du",class:(0,n.C_)({"p-error":s.vAdd$.contrat_du.$invalid&&s.submitted})},G,2),s.vAdd$.contrat_du.$invalid&&s.submitted||s.vAdd$.contrat_du.$pending.$response?((0,t.wg)(),(0,t.iD)("small",K,"ce champ est obligatoire")):(0,t.kq)("",!0)])]),(0,t.Wm)(h,{align:"center",type:"dotted"},{default:(0,t.w5)((()=>[X])),_:1}),(0,t._)("div",J,[(0,t._)("span",Q,[(0,t.Wm)(y,{id:"dropdown",modelValue:s.vAdd$.type_choisie.$model,"onUpdate:modelValue":a[7]||(a[7]=e=>s.vAdd$.type_choisie.$model=e),options:s.type_class,onChange:a[8]||(a[8]=e=>s.functionShow(e)),optionValue:"value",optionLabel:"label"},null,8,["modelValue","options"]),(0,t._)("label",{for:"prix_TTC",class:(0,n.C_)({"p-error":s.vAdd$.type_choisie.$invalid&&s.submitted})},te,2),s.vAdd$.type_choisie.$invalid&&s.submitted||s.vAdd$.type_choisie.$pending.$response?((0,t.wg)(),(0,t.iD)("small",ne,"ce champ est obligatoire ")):(0,t.kq)("",!0)])]),(0,t._)("div",oe,[(0,t.wy)((0,t._)("span",{class:(0,n.C_)(s.showTrache?"p-float-label":"")},[(0,t.Wm)(x,{id:"nbr_tranche",showButtons:"",incrementButtonIcon:"pi pi-plus",min:1,max:10,decrementButtonIcon:"pi pi-minus",decrementButtonClass:"p-button-danger",incrementButtonClass:"p-button-success",modelValue:s.vAdd$.nbr_tranche.$model,"onUpdate:modelValue":a[9]||(a[9]=e=>s.vAdd$.nbr_tranche.$model=e),class:(0,n.C_)({"p-invalid":s.vAdd$.nbr_tranche.$invalid&&s.submitted})},null,8,["modelValue","class"]),(0,t._)("label",{for:"nbr_tranche",class:(0,n.C_)({"p-error":s.vAdd$.nbr_tranche.$invalid&&s.submitted})},ue,2),s.vAdd$.nbr_tranche.$invalid&&s.submitted||s.vAdd$.nbr_tranche.$pending.$response?((0,t.wg)(),(0,t.iD)("small",ce,"ce champ est obligatoire")):(0,t.kq)("",!0)],2),[[o.F8,s.showTrache]])]),(0,t.wy)((0,t._)("div",null,(0,n.zw)(s.tranchesList),513),[[o.F8,!1]]),((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(s.dynamicTrache,((e,a)=>((0,t.wg)(),(0,t.iD)("div",{key:a,class:"grid col-12"},[(0,t.wy)((0,t.Wm)(h,{align:"center"},{default:(0,t.w5)((()=>[(0,t._)("span",se,"Tranche "+(0,n.zw)(e.num_tranche),1)])),_:2},1536),[[o.F8,s.showTrache]]),(0,t.wy)((0,t._)("div",pe,[(0,t._)("span",me,[(0,t.Wm)(x,{id:"taux_tranche",prefix:"%",min:0,max:100,onBlur:e=>s.updateTrancheValue(a,"taux_tranche",e),onClick:e=>s.updateTrancheValue(a,"taux_tranche",e),value:e.taux_tranche,modelValue:e.taux_tranche,"onUpdate:modelValue":a=>e.taux_tranche=a},null,8,["onBlur","onClick","value","modelValue","onUpdate:modelValue"]),ve])],512),[[o.F8,s.showTrache]]),(0,t.wy)((0,t._)("div",_e,[(0,t._)("span",$e,[(0,t.Wm)(x,{id:"prix_prevue",mode:"currency",currency:"DZD",min:0,value:e.prix_prevue,modelValue:e.prix_prevue,"onUpdate:modelValue":a=>e.prix_prevue=a},null,8,["value","modelValue","onUpdate:modelValue"]),fe])],512),[[o.F8,s.showTrache]]),(0,t.wy)((0,t._)("div",he,[(0,t._)("span",ge,[(0,t.Wm)(w,{id:"prochaine_rdv_prevue",modelValue:e.prochaine_rdv_prevue,"onUpdate:modelValue":a=>e.prochaine_rdv_prevue=a,value:e.prochaine_rdv_prevue,onDateSelect:e=>s.updateTrancheValue(a,"prochaine_rdv_prevue",e),showIcon:!0,dateFormat:"dd/mm/yy"},null,8,["modelValue","onUpdate:modelValue","value","onDateSelect"]),xe])],512),[[o.F8,s.showTrache]])])))),128))])])),footer:(0,t.w5)((()=>[(0,t._)("div",Te,[(0,t.Wm)(V,{label:"Back",onClick:a[10]||(a[10]=e=>s.prevPage1()),icon:"pi pi-angle-left"}),(0,t.Wm)(V,{label:"Next",onClick:a[11]||(a[11]=e=>s.nextPage1()),icon:"pi pi-angle-right",iconPos:"right"})])])),_:1})])}var Ae=l(2262),Ce=l(7877),ye=l(2587),we=l(4028),Ve={name:"EtatFacture",emits:["nextpage","prevpage"],props:{formData:Object},setup(e,{emit:a}){const l={num_facture:{required:ye.C1},contrat_du:{required:ye.C1},type_choisie:{required:ye.C1},TVA:{required:ye.C1},prix_TTC:{required:ye.C1,decimal:ye.gH},prix_HT:{required:ye.C1,decimal:ye.gH},date_verser_banque:{},fin_contrat:{},nbr_tranche:{numeric:ye.uR},tranches:{num_tranche:{numeric:ye.uR},prix_prevue:{decimal:ye.gH},prochaine_rdv_prevue:{}},montant_vente:{decimal:ye.gH},montant_reel:{required:ye.C1,decimal:ye.gH},montant_verser:{decimal:ye.gH}},n=(0,Ae.iH)({num_facture:"",contrat_du:"",type_choisie:"",TVA:0,prix_TTC:0,prix_HT:0,date_verser_banque:null,fin_contrat:new Date,nbr_tranche:0,montant_vente:0,montant_reel:0,montant_verser:0,tranches:[{num_tranche:1,prix_prevue:0,prochaine_rdv_prevue:""}]}),o=(0,we.Xw)(l,n.value),r=(0,Ae.iH)(),d=(0,Ae.iH)(),i=(0,Ae.iH)(),u=(0,Ae.iH)(!1),c=(0,Ae.iH)(!1),s=(0,Ae.iH)(),p=(0,Ae.iH)((new Date).toISOString()),m=(0,Ae.iH)((new Date).toISOString()),v=(0,Ae.iH)((new Date).toISOString()),_=(0,Ae.iH)((new Date).toISOString()),$=(0,Ae.iH)((new Date).toISOString()),f=(0,Ae.iH)([{name:"Tva 9%",label:"9 %",value:9},{name:"Tva 19%",label:"19 %",value:19}]),h=(0,Ae.iH)(!1),g=(0,Ae.qj)([{montantHt:"",montantReel:"",tva:""}]),x=(0,Ae.iH)(null),T=(0,Ae.iH)(),b=(0,Ae.iH)([{label:"Oui",value:"OUI"},{label:"Non",value:"NON"}]);function A(e){const a=g.findIndex((a=>a.montantHt===e.montantHt&&a.SecteurActivite===e.SecteurActivite&&a.montantReel===e.montantReel&&a.tva===e.tva));g.splice(a,1)}const C=(0,Ae.iH)(!1);function y(e){console.log(e),"OUI"==e.value?C.value=!0:C.value=!1}function w(){productDialog3.value=!0}function V(){g.push(n.value),n.value={},productDialog3.value=!1}const k=(0,Ae.iH)();function H(){o.value.$invalid?u.value=!0:"OUI"==o.value.type_choisie.$model?(n.value.montant_vente=o.value.prix_HT.$model,n.value.prix_TTC=o.value.prix_TTC.$model,n.value.tranches=z.value,a("nextpage",{formData:{facture:n.value},pageIndex:2})):(n.value={},n.value.num_facture=o.value.num_facture.$model,n.value.contrat_du=o.value.contrat_du.$model,n.value.TVA=o.value.TVA.$model,n.value.prix_TTC=o.value.prix_TTC.$model,n.value.prix_HT=o.value.prix_HT.$model,n.value.date_verser_banque=o.value.date_verser_banque.$model,n.value.type_choisie=o.value.type_choisie.$model,n.value.montant_vente=o.value.montant_vente.$model,n.value.montant_reel=o.value.montant_reel.$model,a("nextpage",{formData:{facture:n.value},pageIndex:2}))}function D(){S.value=!1,a("prevpage",{pageIndex:2})}function U(e){let{newData:a,index:l}=e;g[l]=a}function F(e){selectedColumns.value=columns.value.filter((a=>e.includes(a)))}function I(e){selectedColumns=e.checked?g.map((e=>e.value)):[]}function B(){o.value.prix_TTC.$model=parseFloat(o.value.prix_HT.$model)+parseFloat(parseFloat(o.value.prix_HT.$model)*parseFloat(o.value.TVA.$model))}function q(){Ce.Z.get("/facture-clients/?num_facture="+k.value+"&limit=1").then((e=>{e.data.length>0?(p.value=e.data[0].contrat_du,s.value=e.data[0].TVA,prix_TTC.value=e.data[0].prix_TTC,prix_HT.value=e.data[0].prix_HT,$.value=e.data[0].fin_contrat,montant_reel.value=e.data[0].montant_reel,montant_vente.value=e.data[0].montant_vente,Ce.Z.get("/tranches/?fact_client="+e.data[0].id).then((e=>{e.data!={}?(T.value="OUI",y(T),r.value=e.data.nbr_tranche,d.value=e.data.num_tranche,prix_prevue.value=e.data.prix_prevue,i.value=e.data.prix_realise,montant_verser.value=e.data.fact_client.montant_verser,_.value=e.data.fact_client.date_verser_banque,v.value=e.data.prochaine_rdv_prevue,m.value=e.data.prochaine_rdv_realise):(T.value="NON",y(T),r.value="",d.value="",prix_prevue.value="",i.value="",montant_verser.value="",_.value="",v.value="",m.value="")})).catch((e=>{console.log(e.response.data)}))):(p.value="",s.value="",prix_TTC.value="",prix_HT.value="",$.value="",montant_reel.value="",montant_vente.value="",T.value="NON",y(T),r.value="",d.value="",prix_prevue.value="",i.value="",montant_verser.value="",_.value="",v.value="",m.value="")})).catch((e=>{console.log(e)}))}o.value.prix_TTC.$model=(0,t.Fl)((()=>parseFloat(o.value.prix_HT.$model)+parseFloat(parseFloat(o.value.prix_HT.$model)*(parseFloat(o.value.TVA.$model)/100)))),o.value.num_facture.$model=(0,t.Fl)((()=>e.formData.num_facture)),n.value.num_facture=(0,t.Fl)((()=>o.value.num_facture.$model));const S=(0,Ae.iH)(!1),W=(0,t.Fl)((()=>"PS"==e.formData.type_choisie?e.formData.box.num_place.prix_ht:"AP"==e.formData.type_choisie?e.formData.appartement.prix_ht:e.formData.locale.num_place.prix_ht));function O(e){S.value=e,S.value?o.value.montant_reel.$model=W.value:W.value=o.value.montant_reel.$model}const z=(0,Ae.iH)([]);(0,t.YP)((()=>{const e=[];for(let a=1;a<=o.value.nbr_tranche.$model;a++)e.push({num_tranche:a,taux_tranche:0,prix_prevue:0,prix_realise:0,prochaine_rdv_prevue:"",prochaine_rdv_realise:""});z.value=e}));var R=(0,Ae.iH)(z.value.map((e=>({...e}))));function N(e,a,l){"prochaine_rdv_prevue"==a?R.value[e].prochaine_rdv_prevue=l.toISOString():void 0!=l.value&&(R.value[e].prix_prevue=parseFloat(l.value.replace("%",""))*o.value.montant_reel.$model/100)}return(0,t.m0)((()=>{R.value=z.value})),{dynamicTrache:z,tranchesList:R,updateTrancheValue:N,changeMontantReel:O,MotantUpdated:S,motantReelupdated:W,editingRows:x,num_facture:k,vAdd$:o,classes:g,TVA:s,type_choisie:T,type_class:b,contrat_du:p,fin_contrat:$,classTva:f,showTrache:C,showFacture:h,date_verser_banque:_,nextPage1:H,prevPage1:D,onRowEditSave:U,onSelectAllChange:I,functionShow:y,onToggle:F,getFactureExist:q,vAdd$:o,submitted:u,openNew:w,newFacture:n,addSite:V,DeleteG:A,calculatePrixTTC:B,searching:c,nbr_tranche:r,num_tranche:d,prochaine_rdv_prevue:v,prochaine_rdv_realise:m}}},ke=l(3744);const He=(0,ke.Z)(Ve,[["render",be]]);var De=He}}]);
//# sourceMappingURL=798.bb54b8aa.js.map