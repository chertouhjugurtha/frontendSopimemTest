"use strict";(self["webpackChunksopimem"]=self["webpackChunksopimem"]||[]).push([[897],{3897:function(e,l,a){a.r(l),a.d(l,{default:function(){return Fe}});var s=a(6252),o=a(3577),r=a(9963);const i=e=>((0,s.dD)("data-v-cb88c508"),e=e(),(0,s.Cn)(),e),t={class:"grid"},n={class:"col-12 xl:col-12"},d={class:"card"},u=i((()=>(0,s._)("div",{class:"header"},[(0,s._)("h1",null,"Utilisateurs")],-1))),m=i((()=>(0,s._)("br",null,null,-1))),c={class:"formgrid grid"},p={class:"field col"},f={class:"p-float-label"},v=i((()=>(0,s._)("label",{for:"firstname"},"Fisrtname",-1))),b={class:"field col"},w={class:"p-float-label"},g=i((()=>(0,s._)("label",{for:"lastname"},"Lastname",-1))),y=i((()=>(0,s._)("br",null,null,-1))),h={class:"formgrid grid"},_={class:"field col"},k={class:"p-float-label"},D=i((()=>(0,s._)("label",{for:"email"},"E-mail",-1))),V={class:"field col"},U={class:"p-float-label"},W=i((()=>(0,s._)("label",{for:"mobile"},"Téléphone",-1))),P=i((()=>(0,s._)("br",null,null,-1))),S={class:"formgrid grid"},N={class:"field col"},R={class:"p-float-label"},E=i((()=>(0,s._)("label",{for:"wilaya"},"Wilaya",-1))),C={class:"field col"},T={class:"p-float-label"},L=i((()=>(0,s._)("label",{for:"wilaya"},"Commune",-1))),H={class:"formgrid grid"},x={class:"field col"},A={class:"field-checkbox mb-0"},K=i((()=>(0,s._)("label",{for:"verifyEmail"},"Verify Email?",-1))),I=i((()=>(0,s._)("h5",null,"Liste des utilisateurs",-1))),M={class:"flex justify-content-between flex-column sm:flex-row"},B=(0,s.Uk)("  "),O={class:"p-input-icon-left mb-2"},j=i((()=>(0,s._)("i",{class:"pi pi-search"},null,-1))),Z=(0,s.Uk)(" Email "),q=(0,s.Uk)("Null"),F=(0,s.Uk)(" Created At "),z=(0,s.Uk)("Null"),J=(0,s.Uk)(" Actions "),Y={class:""},G=i((()=>(0,s._)("br",null,null,-1))),$={class:"field col-12"},Q={class:"p-float-label"},X=i((()=>(0,s._)("label",{for:"password"},"Nouveau mots de passe",-1))),ee={class:"field col-12"},le={class:"p-float-label"},ae=i((()=>(0,s._)("label",{for:"passwordConfirm"},"Confirmer le mots de passe",-1))),se={class:"field col-12"},oe={class:"field-checkbox mb-0"},re=i((()=>(0,s._)("label",{for:"binary"},"Temporare",-1))),ie=i((()=>(0,s._)("br",null,null,-1))),te={class:"formgrid grid"},ne={class:"field col"},de={class:"p-label"},ue=i((()=>(0,s._)("label",{for:"firstnameDetail"},"Nom",-1))),me={class:"field col"},ce={class:"p-label"},pe=i((()=>(0,s._)("label",{for:"lastnameDetail"},"Prénom",-1))),fe={class:"formgrid grid"},ve={class:"field col"},be={class:"p-label"},we=i((()=>(0,s._)("label",{for:"usernameDetail"},"Nom d'utilisateur",-1))),ge={class:"field col"},ye={class:"p-label"},he=i((()=>(0,s._)("label",{for:"emailDetail"},"Email",-1))),_e={class:"formgrid grid"},ke={key:0,class:"field col"},De={class:"p-label"},Ve=i((()=>(0,s._)("label",{for:"mobileDetail"},"Mobile",-1))),Ue={key:1,class:"field col"},We={class:"p-label"},Pe=i((()=>(0,s._)("label",{for:"addressDetail"},"Adresse",-1))),Se={class:"field col"},Ne={key:0,class:"p-label"},Re=i((()=>(0,s._)("label",{for:"role"},"Role",-1))),Ee={key:1,class:"p-float-label"},Ce=i((()=>(0,s._)("label",{for:"roleDetail"},"Rôle",-1)));function Te(e,l,a,i,Te,Le){const He=(0,s.up)("Button"),xe=(0,s.up)("Toolbar"),Ae=(0,s.up)("InputText"),Ke=(0,s.up)("InputMask"),Ie=(0,s.up)("Dropdown"),Me=(0,s.up)("Checkbox"),Be=(0,s.up)("Dialog"),Oe=(0,s.up)("Column"),je=(0,s.up)("SplitButton"),Ze=(0,s.up)("DataTable"),qe=(0,s.up)("Password"),Fe=(0,s.up)("Toast"),ze=(0,s.up)("ConfirmDialog");return(0,s.wg)(),(0,s.iD)("div",t,[(0,s._)("div",n,[(0,s._)("div",d,[u,(0,s.Wm)(xe,{class:"mb-4"},{start:(0,s.w5)((()=>[(0,s.Wm)(He,{label:"Ajouter",icon:"pi pi-plus",class:"p-button-success mr-2",onClick:i.openNew},null,8,["onClick"])])),_:1}),(0,s.Wm)(Be,{visible:i.userDialog,"onUpdate:visible":l[12]||(l[12]=e=>i.userDialog=e),style:{width:"600px"},header:"Ajouter un nouveau utilisateur",modal:!0,class:"p-fluid"},(0,s.Nv)({default:(0,s.w5)((()=>[m,(0,s._)("div",c,[(0,s._)("div",p,[(0,s._)("span",f,[(0,s.Wm)(Ae,{id:"firstname",modelValue:e.firstName,"onUpdate:modelValue":l[0]||(l[0]=l=>e.firstName=l)},null,8,["modelValue"]),v])]),(0,s._)("div",b,[(0,s._)("span",w,[(0,s.Wm)(Ae,{id:"lastname",modelValue:e.lastName,"onUpdate:modelValue":l[1]||(l[1]=l=>e.lastName=l)},null,8,["modelValue"]),g])])]),y,(0,s._)("div",h,[(0,s._)("div",_,[(0,s._)("span",k,[(0,s.Wm)(Ae,{id:"email",modelValue:e.email,"onUpdate:modelValue":l[2]||(l[2]=l=>e.email=l),onKeydown:l[3]||(l[3]=l=>i.validateEmailOnKey(e.email)),onKeyup:l[4]||(l[4]=l=>i.validateEmailOnKey(e.email))},null,8,["modelValue"]),D]),(0,s.wy)((0,s._)("small",{class:"p-error"},(0,o.zw)(e.emailError),513),[[r.F8,e.emailError]])]),(0,s._)("div",V,[(0,s._)("span",U,[(0,s.Wm)(Ke,{mask:"(213) 9-99-99-99-99",id:"mobile",modelValue:e.attributes.mobile,"onUpdate:modelValue":l[5]||(l[5]=l=>e.attributes.mobile=l)},null,8,["modelValue"]),W])])]),P,(0,s._)("div",S,[(0,s._)("div",N,[(0,s._)("span",R,[(0,s.Wm)(Ie,{id:"wilaya",filter:!0,modelValue:e.wilaya,"onUpdate:modelValue":l[6]||(l[6]=l=>e.wilaya=l),options:i.Wilayas,optionLabel:"ar"==i.localeLang?"ar_name":"name",optionValue:"code",onChange:l[7]||(l[7]=e=>i.getCommuneByWilaya())},null,8,["modelValue","options","optionLabel"]),E])]),(0,s._)("div",C,[(0,s._)("span",T,[(0,s.Wm)(Ie,{id:"wilaya",filter:!0,modelValue:e.commune,"onUpdate:modelValue":l[8]||(l[8]=l=>e.commune=l),options:i.communesByWilaya,optionLabel:"ar"==i.localeLang?"commune_name":"commune_name_ascii",optionValue:"id"},null,8,["modelValue","options","optionLabel"]),L])])]),(0,s._)("div",H,[(0,s._)("div",x,[(0,s._)("div",A,[(0,s.Wm)(Me,{id:"verifyEmail",modelValue:e.emailVerified,"onUpdate:modelValue":l[9]||(l[9]=l=>e.emailVerified=l),binary:!0},null,8,["modelValue"]),K])])])])),_:2},[i.validNewUserState?{name:"footer",fn:(0,s.w5)((()=>[(0,s.Wm)(He,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:l[10]||(l[10]=e=>i.userDialog=!1)}),(0,s.Wm)(He,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:l[11]||(l[11]=e=>i.addNewUser())})]))}:void 0]),1032,["visible"]),I,(0,s.Wm)(Ze,{value:i.filterRole?i.usersFilteredByRole:i.users,paginator:!0,rows:10,dataKey:"id",rowHover:!0,filters:i.filters1,"onUpdate:filters":l[17]||(l[17]=e=>i.filters1=e),filterDisplay:"menu",loading:i.loading1,responsiveLayout:"scroll",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[10,25,50],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",globalFilterFields:["username","firstName","lastName","email"]},{header:(0,s.w5)((()=>[(0,s._)("div",M,[(0,s._)("div",null,[(0,s.Wm)(He,{type:"button",icon:"pi pi-filter-slash",label:"Vider",class:"p-button-outlined mb-2",onClick:l[13]||(l[13]=e=>i.clearFilter1())}),B,(0,s.Wm)(Ie,{class:"p-button-outlined mb-2",modelValue:i.filterRole,"onUpdate:modelValue":l[14]||(l[14]=e=>i.filterRole=e),options:[...i.allRealmRoles,{name:"Withou Role"}],optionLabel:"name",optionValue:"name",placeholder:"Filtrer par rôle",onChange:l[15]||(l[15]=e=>i.getUsersByRole())},null,8,["modelValue","options"])]),(0,s._)("span",O,[j,(0,s.Wm)(Ae,{modelValue:i.filters1["global"].value,"onUpdate:modelValue":l[16]||(l[16]=e=>i.filters1["global"].value=e),placeholder:"Rechercher ...",style:{width:"100%"}},null,8,["modelValue"])])])])),default:(0,s.w5)((()=>[(0,s.Wm)(Oe,{field:"username",header:"Nom utilisateur",sortable:!0,style:{width:"8%"}},{body:(0,s.w5)((({data:e})=>[(0,s.Uk)((0,o.zw)(e.username),1)])),filter:(0,s.w5)((({filterModel:e})=>[(0,s.Wm)(Ae,{type:"text",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,class:"p-column-filter",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,s.Wm)(Oe,{field:"firstName",header:"nom",sortable:!0,style:{width:"8%"}},{body:(0,s.w5)((({data:e})=>[(0,s.Uk)((0,o.zw)(e.firstName),1)])),filter:(0,s.w5)((({filterModel:e})=>[(0,s.Wm)(Ae,{type:"text",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,class:"p-column-filter",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,s.Wm)(Oe,{field:"lastName",header:"prénom",sortable:!0,style:{width:"8%"}},{body:(0,s.w5)((({data:e})=>[(0,s.Uk)((0,o.zw)(e.lastName),1)])),filter:(0,s.w5)((({filterModel:e})=>[(0,s.Wm)(Ae,{type:"text",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,class:"p-column-filter",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,s.Wm)(Oe,{style:{width:"10%"},field:"email"},{header:(0,s.w5)((()=>[Z])),body:(0,s.w5)((({data:e})=>[e?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Uk)((0,o.zw)(e.email),1)],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[q],64))])),filter:(0,s.w5)((({filterModel:e})=>[(0,s.Wm)(Ae,{type:"text",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,class:"p-column-filter",placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,s.Wm)(Oe,{style:{width:"10%"},field:"createdTimestamp",sortable:!0},{header:(0,s.w5)((()=>[F])),body:(0,s.w5)((({data:e})=>[e?((0,s.wg)(),(0,s.iD)(s.HY,{key:0},[(0,s.Uk)((0,o.zw)(new Date(e.createdTimestamp).toLocaleDateString("ar"==i.localeLang?"ar-DZ":"fr"==i.localeLang?"fr-FR":"en-US",{weekday:"long",year:"numeric",month:"numeric",day:"numeric"})),1)],64)):((0,s.wg)(),(0,s.iD)(s.HY,{key:1},[z],64))])),filter:(0,s.w5)((({filterModel:e})=>[(0,s.Wm)(Ae,{type:"text",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,class:"p-column-filter",placeholder:"Recherche par nom"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),(0,s.Wm)(Oe,{style:{width:"1.5%"}},(0,s.Nv)({header:(0,s.w5)((()=>[J])),_:2},[i.users?{name:"body",fn:(0,s.w5)((e=>[(0,s._)("span",Y,[(0,s.Wm)(je,{style:{direction:"ltr"},onClick:l=>i.openUserRole(e.data.id),label:"Détails",icon:"pi pi-user-edit",model:[e.data.enabled?{label:"Bloquer",icon:"pi pi-lock",command:()=>{i.lockUser(e.data.id)}}:{label:"débloquer",icon:"pi pi-lock-open",command:()=>{i.unLockUser(e.data.id)}},{label:"attribuer mots de passe",icon:"pi pi-key",command:()=>{i.changePasswordUser(e.data.id)}},{label:"Supprimer",icon:"pi pi-trash",command:()=>{i.deleteUser(e.data.id)}}],class:"p-button-outlined p-button-secondary mb-2"},null,8,["onClick","model"])])]))}:void 0]),1024)])),_:1},8,["value","filters","loading"]),(0,s.Wm)(Be,{visible:i.userPasswordDialog,"onUpdate:visible":l[27]||(l[27]=e=>i.userPasswordDialog=e),style:{width:"450px"},header:"Set user password",modal:!0,class:"p-fluid"},(0,s.Nv)({default:(0,s.w5)((()=>[G,(0,s._)("div",$,[(0,s._)("span",Q,[(0,s.Wm)(qe,{id:"password",modelValue:e.newPassword,"onUpdate:modelValue":l[18]||(l[18]=l=>e.newPassword=l),toggleMask:"",onKeyup:l[19]||(l[19]=l=>i.checkPasswordOnKey(e.newPassword,8)),onKeydown:l[20]||(l[20]=l=>i.checkPasswordOnKey(e.newPassword,8))},null,8,["modelValue"]),X]),(0,s.wy)((0,s._)("small",{class:"p-error"},(0,o.zw)(e.lengthError),513),[[r.F8,!i.validLengthPasswordState&&e.lengthError]])]),(0,s._)("div",ee,[(0,s._)("span",le,[(0,s.Wm)(qe,{id:"passwordConfirm",modelValue:e.confirmPassword,"onUpdate:modelValue":l[21]||(l[21]=l=>e.confirmPassword=l),toggleMask:"",onKeyup:l[22]||(l[22]=l=>i.checkTowPasswordValid(e.newPassword,e.confirmPassword)),onKeydown:l[23]||(l[23]=l=>i.checkTowPasswordValid(e.newPassword,e.confirmPassword))},null,8,["modelValue"]),ae]),(0,s.wy)((0,s._)("small",{class:"p-error"},(0,o.zw)(e.matchError),513),[[r.F8,!i.validPasswordState&&e.matchError]])]),(0,s._)("div",se,[(0,s._)("div",oe,[(0,s.Wm)(Me,{id:"binary",modelValue:e.temporaryPassword,"onUpdate:modelValue":l[24]||(l[24]=l=>e.temporaryPassword=l),binary:!0},null,8,["modelValue"]),re])])])),_:2},[i.validPasswordState?{name:"footer",fn:(0,s.w5)((()=>[(0,s.Wm)(He,{label:"Cancel",icon:"pi pi-times",class:"p-button-text",onClick:l[25]||(l[25]=e=>i.userPasswordDialog=!1)}),(0,s.Wm)(He,{label:"Save",icon:"pi pi-check",class:"p-button-text",onClick:l[26]||(l[26]=e=>i.updatePasswordUser())})]))}:void 0]),1032,["visible"]),(0,s.Wm)(Be,{visible:i.userRoleDialog,"onUpdate:visible":l[31]||(l[31]=e=>i.userRoleDialog=e),style:{width:"650px"},header:"détails sur l'utilisateur",modal:!0,class:"p-fluid"},(0,s.Nv)({default:(0,s.w5)((()=>[ie,(0,s._)("div",te,[(0,s._)("div",ne,[(0,s._)("span",de,[ue,(0,s.Wm)(Ae,{style:{border:"none"},id:"firstnameDetail",value:i.userDetail.firstName,disabled:!0},null,8,["value"])])]),(0,s._)("div",me,[(0,s._)("span",ce,[pe,(0,s.Wm)(Ae,{style:{border:"none"},id:"lastnameDetail",value:i.userDetail.lastName,disabled:!0},null,8,["value"])])])]),(0,s._)("div",fe,[(0,s._)("div",ve,[(0,s._)("span",be,[we,(0,s.Wm)(Ae,{style:{border:"none"},id:"usernameDetail",value:i.userDetail.username,disabled:!0},null,8,["value"])])]),(0,s._)("div",ge,[(0,s._)("span",ye,[he,(0,s.Wm)(Ae,{style:{border:"none"},id:"emailDetail",value:i.userDetail.email,disabled:!0},null,8,["value"])])])]),(0,s._)("div",_e,[i.userDetail.attributes.mobile?((0,s.wg)(),(0,s.iD)("div",ke,[(0,s._)("span",De,[Ve,(0,s.Wm)(Ae,{style:{border:"none"},id:"mobileDetail",value:i.userDetail.attributes.mobile,disabled:!0},null,8,["value"])])])):(0,s.kq)("",!0),i.userDetail.attributes.address?((0,s.wg)(),(0,s.iD)("div",Ue,[(0,s._)("span",We,[Pe,"ar"==i.localeLang?((0,s.wg)(),(0,s.j4)(Ae,{key:0,style:{border:"none"},id:"addressDetail",value:JSON.parse(i.userDetail.attributes.address).commune_name+" "+JSON.parse(i.userDetail.attributes.address).daira_name+" "+JSON.parse(i.userDetail.attributes.address).wilaya_name,disabled:!0},null,8,["value"])):((0,s.wg)(),(0,s.j4)(Ae,{key:1,style:{border:"none"},id:"addressDetail",value:JSON.parse(i.userDetail.attributes.address).commune_name_ascii+" "+JSON.parse(i.userDetail.attributes.address).daira_name_ascii+" "+JSON.parse(i.userDetail.attributes.address).wilaya_name_ascii,disabled:!0},null,8,["value"]))])])):(0,s.kq)("",!0)]),(0,s._)("div",Se,[i.roleUser.length?((0,s.wg)(),(0,s.iD)("span",Ne,[Re,((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(i.roleUser,(e=>((0,s.wg)(),(0,s.iD)("h5",{key:e.id},(0,o.zw)(e.name),1)))),128))])):((0,s.wg)(),(0,s.iD)("span",Ee,[(0,s.Wm)(Ie,{id:"roleDetail",modelValue:e.role,"onUpdate:modelValue":l[28]||(l[28]=l=>e.role=l),options:i.allRealmRoles,optionLabel:"name",optionValue:"name"},null,8,["modelValue","options"]),Ce]))])])),_:2},[i.roleUser.length?void 0:{name:"footer",fn:(0,s.w5)((()=>[(0,s.Wm)(He,{label:"Annuler",icon:"pi pi-times",class:"p-button-text",onClick:l[29]||(l[29]=e=>i.userRoleDialog=!1)}),(0,s.Wm)(He,{label:"Enregester",icon:"pi pi-check",class:"p-button-text",onClick:l[30]||(l[30]=e=>i.setUserRole())})]))}]),1032,["visible"]),(0,s.Wm)(Fe),(0,s.Wm)(ze)])])])}var Le=a(6358),He=a(2262),xe=a(3907),Ae=a(7877),Ke=a(9201),Ie=a(1039),Me=a(2201),Be=a(7379),Oe=a(9645),je={name:"users",props:{roles:{type:Array,default:[]}},setup(e){const l=(0,He.qj)({wilaya:null,commune:null}),a=(0,He.iH)([]),s=(0,He.iH)(window.innerWidth),o=(0,Ie.N)(),r=(0,Ke.p)(),i=(0,xe.oR)(),t=(0,He.iH)(!1),n=(0,He.iH)(!1),d=(0,He.iH)(!1),u=(0,He.qj)({userID:null,newPassword:"",confirmPassword:"",temporaryPassword:!1}),m=(0,He.iH)(!0),c=(0,He.iH)(!0),p=(0,He.qj)({lengthError:"",matchError:""}),f=(0,He.qj)({emailError:""}),v=(0,Me.tv)(),b=(0,He.iH)([]),w=(0,He.iH)([]),g=(0,He.iH)({}),y=(0,He.iH)({}),h=(0,He.iH)([]),_=(0,He.iH)(!0),k=(0,He.iH)([]),D=(0,He.qj)({role:"",userID:""}),V=(0,He.iH)(""),U=(0,He.qj)({username:"",firstName:"",lastName:"",email:"",enabled:!0,emailVerified:!1,access:{manageGroupMembership:!0,view:!0,mapRoles:!0,impersonate:!0,manage:!0},attributes:{mobile:"",address:{}},realmRoles:[]}),W=(0,He.iH)(localStorage.getItem("localeLang")),P=(0,He.iH)(null),S=(0,He.iH)(!0);function N(){a.value=Oe.filter((e=>e.wilaya_code==l.wilaya)),a.value.sort(((e,l)=>e.id>l.id)),console.log(a)}function R(){let l=[];e.roles.forEach((e=>{console.log(e,"kkkkkkkkkkkkk",i.state.endpoints.login+"admin/realms/espace_enterprise/roles/"+e+"/users"),Ae.Z.get(i.state.endpoints.login+"admin/realms/espace_enterprise/roles/"+e+"/users").then((a=>{console.log(a.data,'""""""""""'),l=a.data.filter((e=>e.id!==i.state.user.id)),g.value[e]=[...l],g.value[e].sort(((e,l)=>e.createdTimestamp<l.createdTimestamp)),S.value=!1})).catch((e=>{console.log(e)}))}))}function E(){Ae.Z.get(i.state.endpoints.login+"admin/realms/espace_enterprise/users").then((e=>{b.value=e.data.filter((e=>e.id!==i.state.user.id)),b.value.sort(((e,l)=>e.createdTimestamp<l.createdTimestamp)),S.value=!1})).catch((e=>{console.log(e)}))}function C(){P.value={global:{value:null,matchMode:Le.a6.CONTAINS},username:{operator:Le.pg.AND,constraints:[{value:null,matchMode:Le.a6.STARTS_WITH}]},firstName:{operator:Le.pg.AND,constraints:[{value:null,matchMode:Le.a6.STARTS_WITH}]},lastName:{operator:Le.pg.AND,constraints:[{value:null,matchMode:Le.a6.STARTS_WITH}]},email:{operator:Le.pg.AND,constraints:[{value:null,matchMode:Le.a6.STARTS_WITH}]}}}function T(){S.value=!0,C(),V.value="",S.value=!1}function L(){t.value=!0}function H(e){y.value=b.value.find((l=>l.id==e))}function x(){if(S.value=!0,w.value=[],"Withou Role"===V.value){let e=Object.values(g.value),l=[];for(const a in e)l.push(...e[a]);b.value.forEach((e=>{l.find((l=>l.id==e.id))||w.value.push(e)}))}else w.value=g.value[V.value];S.value=!1}function A(){Ae.Z.get(i.state.endpoints.login+"admin/realms/espace_enterprise/roles").then((l=>{k.value=l.data.filter((l=>e.roles.includes(l.name)))})).catch((e=>{console.log(e)}))}R(),E(),C();const K=e=>!!String(e).toLowerCase().match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,3}))$/),I=e=>{K(e)?(f.emailError="",_.value=!0):(f.emailError="Invalid email",_.value=!1)};function M(){U.username=U.firstName+"_"+Math.floor(1e4*Math.random()),U.attributes.address=JSON.stringify(Oe.find((e=>e.id==l.commune))),K(U.email)?(f.emailError="",_.value=!0,Ae.Z.post(i.state.endpoints.login+"admin/realms/espace_enterprise/users",U).then((()=>{r.add({severity:"success",summary:"Successful",detail:"user created Successfully",life:1e3}),setTimeout((()=>{V.value="",w.value=[],g.value=[],E(),R(),t.value=!1}),500)})).catch((e=>{r.add({severity:"error",summary:"Error",detail:"unable to create new user : "+e.message+" :\n"+e.response.data.errorMessage,life:2e3})}))):(f.emailError="Invalid email",_.value=!1)}function B(l){Ae.Z.get(i.state.endpoints.login+"admin/realms/espace_enterprise/users/"+l+"/role-mappings/realm/composite").then((l=>{h.value=l.data.filter((l=>e.roles.includes(l.name)))})).catch((e=>{console.log(e)}))}function O(e){d.value=!0,H(e),B(e),D.userID=e}function j(){const e=k.value.find((e=>e.name==D.role));Ae.Z.post(i.state.endpoints.login+"admin/realms/espace_enterprise/users/"+D.userID+"/role-mappings/realm",[{id:e.id,name:D.role,containerId:"espace_enterprise"}]).then((e=>{console.log(e.data),r.add({severity:"success",summary:"Successful",detail:"Set role to user Successfully ",life:1e3}),setTimeout((()=>{V.value="",w.value=[],g.value=[],E(),R(),d.value=!1}),500)})).catch((e=>{r.add({severity:"error",summary:"Error",detail:"unable to set role to user: "+e.message,life:1e3})}))}function Z(e){Ae.Z.put(i.state.endpoints.login+"admin/realms/espace_enterprise/users/"+e,{enabled:!1}).then((e=>{console.log(e.data),r.add({severity:"success",summary:"Successful",detail:"user profile locked",life:1e3}),setTimeout((()=>{v.go()}),500)})).catch((e=>{r.add({severity:"error",summary:"Error",detail:"unable to lock user profile: "+e.message,life:1e3})}))}function q(e){o.require({message:"Are you sure you want to lock this user?",header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-warning",accept:()=>{Z(e)},reject:()=>{r.add({severity:"success",summary:"Successful",detail:"Lock user canceled",life:1e3})}})}function F(e){Ae.Z.put(i.state.endpoints.login+"admin/realms/espace_enterprise/users/"+e,{enabled:!0}).then((e=>{r.add({severity:"success",summary:"Successful",detail:"user profile unlocked",life:1e3}),setTimeout((()=>{v.go()}),500)})).catch((e=>{r.add({severity:"error",summary:"Error",detail:"unable to unlock user profile: "+e.message,life:1e3})}))}function z(e){o.require({message:"Are you sure you want to unlock this user?",header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-warning",accept:()=>{F(e)},reject:()=>{r.add({severity:"success",summary:"Successful",detail:"unlock user canceled",life:1e3})}})}function J(e){Ae.Z["delete"](i.state.endpoints.login+"admin/realms/espace_enterprise/users/"+e).then((e=>{console.log(e.data),r.add({severity:"success",summary:"Successful",detail:"user deleted",life:1e3}),setTimeout((()=>{v.go()}),500)})).catch((e=>{r.add({severity:"error",summary:"Error",detail:"user undeleted: "+e.message,life:1e3})}))}function Y(e){o.require({message:"Are you sure you want to delete this user?",header:"Confirmation",icon:"pi pi-exclamation-triangle",acceptClass:"p-button-danger",accept:()=>{console.log("id from lockUser accept = "+e),J(e)},reject:()=>{r.add({severity:"success",summary:"Successful",detail:"Delete user canceled",life:1e3})}})}function G(e){n.value=!0,u.userID=e,console.log("id user= "+u.userID)}function $(e,l){return e==l}function Q(e,l){$(e,l)?(m.value=!0,p.matchError=""):(m.value=!1,p.matchError="Unmatch passwords")}function X(e,l){return e.length>=l}function ee(e,l){X(e,l)?(c.value=!0,p.lengthError=""):(c.value=!1,p.lengthError="Length passwrod must be more than 8 characters")}function le(){if(console.log("update password"),$(u.newPassword,u.confirmPassword))if(X(u.newPassword,8)){let e={type:"password",value:u.newPassword,temporary:u.temporaryPassword};console.log(e),Ae.Z.put(i.state.endpoints.login+"admin/realms/espace_enterprise/users/"+u.userID+"/reset-password",e).then((e=>{console.log(e.data),r.add({severity:"success",summary:"Successful",detail:"user password updated",life:2e3}),setTimeout((()=>{v.go()}),500)})).catch((e=>{r.add({severity:"error",summary:"Error",detail:"unable set new user password: "+e.message+" : \n"+e.response.data.errorMessage,life:2e3})})),c.value=!0,p.lengthError=""}else c.value=!1,p.lengthError="Length passwrod must be more than 8 characters";else m.value=!1,p.matchError="Unmatch passwords"}return A(),{localeLang:W,windowSize:s,userDialog:t,userPasswordDialog:n,openNew:L,users:b,lockUser:q,unLockUser:z,deleteUser:Y,changePasswordUser:G,...(0,He.BK)(u),updatePasswordUser:le,checkTowPasswordValid:Q,checkPasswordOnKey:ee,validPasswordState:m,validLengthPasswordState:c,...(0,He.BK)(p),filters1:P,loading1:S,clearFilter1:T,...(0,He.BK)(U),allRealmRoles:k,...(0,He.BK)(D),Wilayas:Be,Algeria:Oe,...(0,He.BK)(l),getCommuneByWilaya:N,communesByWilaya:a,addNewUser:M,...(0,He.BK)(f),validateEmailOnKey:I,validNewUserState:_,userRoleDialog:d,openUserRole:O,setUserRole:j,roleUser:h,userDetail:y,getUsersByRole:x,usersFilteredByRole:w,filterRole:V}}},Ze=a(3744);const qe=(0,Ze.Z)(je,[["render",Te],["__scopeId","data-v-cb88c508"]]);var Fe=qe}}]);
//# sourceMappingURL=897.fd5c1e94.js.map