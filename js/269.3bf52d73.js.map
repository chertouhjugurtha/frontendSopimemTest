{"version":3,"file":"js/269.3bf52d73.js","mappings":"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","sources":["webpack://sopimem/./src/components/Notifications.vue","webpack://sopimem/./src/components/Notifications.vue?e79f"],"sourcesContent":["<template>\n    <div class=\"grid\">\n        <div class=\"col-12 xl:col-4\">\n                <div class=\"card\">\n                    <div class=\"flex align-items-center justify-content-between mb-4\">\n                        <h5>Notifications</h5>\n                        <div>\n                        </div>\n                    </div>\n                    <ul ref=\"notificationUl\" class=\"p-0 mx-0 mt-0 mb-4 list-none\" style=\"min-height:350px; height:500px; overflow: auto;\">\n                        <router-link  v-for=\"notif in listNofitications\" :key=\"notif.id\" :to=\"{name:'notif-details','params':{id:notif.id}}\" >\n                            <li class=\"flex align-items-center py-2 border-bottom-1 surface-border link-active\">\n                                <div class=\"w-3rem h-3rem flex align-items-center justify-content-center bg-green-100 border-circle mr-3 flex-shrink-0\">\n                                    <i class=\"pi pi-bell text-xl text-green-500\"></i>\n                                </div>\n                                <div class=\"flex flex-column ml-3\" style=\"flex-grow: 1;\">\n                                    <div class=\"flex align-items-center justify-content-between mb-1\">\n                                        <span class=\"font-bold\" :class=\"!notif.opened?'text-900':'text-500'\">{{notif.subject}}&nbsp;\n                                            <Tag class=\"mr-2\" severity=\"warning\" value=\"Unread\" :rounded=\"true\" v-if=\"!notif.opened\"></Tag>\n                                        </span>\n                                        <small>{{getMomentDate(notif.created_at)}}</small>\n                                    </div>\n                                    <span :class=\"!notif.opened?'text-900':'text-500'\">{{notif.content.substring(0,50)+'...'}}</span>\t\t\t\n                                </div>\n                            </li>\n                        </router-link>\n                        <template v-if=\"!listNofitications.length\">\n                            <li class=\"flex align-items-center py-2 border-bottom-1 surface-border link-active\">\n                                <div class=\"w-3rem h-3rem flex align-items-center justify-content-center bg-blue-100 border-circle mr-3 flex-shrink-0\">\n                                    <i class=\"pi pi-bell text-xl text-blue-500\"></i>\n                                </div>\n                                <div class=\"flex flex-column ml-3\" style=\"flex-grow: 1;\">\n                                        <div class=\"flex align-items-center justify-content-between mb-1\">\n                                            <span class=\"text-700 font-bold\">No message recieved found</span>\n                                        </div>\n                                        <span class=\"text-700\">No data to present</span>\t\t\t\n                                    </div>\n                            </li>\n                        </template>\n                    </ul>\n                </div>\n        </div>\n        <router-view name=\"notifviewdetails\"/>\n    </div>\n</template>\n\n<script>\nimport {ref, reactive, toRefs,onUpdated,provide,nextTick,onMounted} from 'vue'\nimport {useStore} from 'vuex'\nimport api from '../api'\nimport {useRoute,onBeforeRouteUpdate} from 'vue-router'\nimport { useToast } from \"primevue/usetoast\";\nimport moment from 'moment'\nexport default {\n    name: 'Notifications',\n    setup(){\n        const store = useStore()\n        const route = useRoute()\n        const localeLang = ref(localStorage.getItem('localeLang'))\n        const listNofitications = ref([])\n        const nextNotifications = ref('')\n        const scrollToLoad=ref(true)\n        function getListOfNotifications(){\n            api.get('/notifications/?send_to='+store.state.user.id+'&ordering=-created_at')\n            .then(response=>{\n                listNofitications.value = response.data.results.data\n                nextNotifications.value=response.data.next\n                scrollToLoad.value = false\n                //console.log(listNofitications.value);\n            }).catch(error=>console.log(error))\n        }\n        getListOfNotifications()\n        function getMomentDate(date){\n            // moment.locale(localeLang.value=='ar'?'ar-dz':localeLang.value=='fr'?'fr-fr':'en-us')\n            // let momentDate = moment(date.slice(0,10)+' '+date.slice(11,16),'YYYY-MM-DD hh:mm:ss').fromNow()\n            // return momentDate\n            const currentDate = new Date(date);\n            // const utcOffset = 1; // Algeria is UTC+1\n            moment.locale(localeLang.value=='ar'?'ar-dz':localeLang.value=='fr'?'fr-fr':'en-us')\n            let momentDate = moment(currentDate).fromNow()\n            return momentDate\n        }\n        function setNotificationOpened(NotificationID){\n            api.put('/notifications/'+NotificationID+'/set_opened/')\n            .then(response=>{\n                let index = listNofitications.value.findIndex((notify) => notify.id === NotificationID)\n                listNofitications.value[index] = response.data\n            }).catch(error=>{\n                console.log(error);\n            })\n        }\n        const notificationUl=ref(null)\n        function getMoreNotificationMessages(){\n            scrollToLoad.value = true\n            notificationUl.value.onscroll = () => {\n                let bottomOfWindow =  notificationUl._value.scrollHeight - notificationUl._value.scrollTop === notificationUl._value.offsetHeight;\n                //alert(bottomOfWindow)\n                if (bottomOfWindow) {\n                    if(nextNotifications.value !== null){\n                        api.get(nextNotifications.value)\n                        .then(response=>{\n                            \n                            listNofitications.value.push(...response.data.results.data)\n                            nextNotifications.value=response.data.next\n                            scrollToLoad.value = false\n                        }).catch(error=>console.log(error))\n                    }\n                }\n            }\n        }\n        onBeforeRouteUpdate((to,from,next)=>{\n            //console.log('opend');\n            let notif  = listNofitications.value.find(msg=>(msg.id==to.params.id) && !msg.opened)\n            if (notif != undefined){\n                setNotificationOpened(to.params.id)\n                next(false)\n            }else next()\n            \n        })\n        onMounted(() => getMoreNotificationMessages())\n        return {\n            localeLang,listNofitications,nextNotifications,scrollToLoad,getMomentDate,notificationUl\n        }\n    }\n\n}\n</script>\n\n<style>\n\n</style>","import { render } from \"./Notifications.vue?vue&type=template&id=ec1c9074\"\nimport script from \"./Notifications.vue?vue&type=script&lang=js\"\nexport * from \"./Notifications.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"/home/yougarthen/My_data/my_data/my_apps/sopman/SopimemTest/frontend/app/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["class","_createElementVNode","ref","style","_hoisted_11","_createElementBlock","_hoisted_4","_Fragment","_renderList","$setup","notif","_createBlock","_component_router_link","key","id","to","name","_hoisted_7","opened","subject","_component_Tag","severity","value","rounded","_toDisplayString","created_at","content","substring","length","_hoisted_13","_createVNode","_component_router_view","setup","store","useStore","localeLang","useRoute","localStorage","getItem","listNofitications","nextNotifications","scrollToLoad","getListOfNotifications","api","state","user","then","response","data","results","next","catch","error","console","log","getMomentDate","date","currentDate","Date","moment","momentDate","fromNow","setNotificationOpened","NotificationID","index","findIndex","notify","notificationUl","getMoreNotificationMessages","onscroll","bottomOfWindow","_value","scrollHeight","scrollTop","offsetHeight","push","onBeforeRouteUpdate","from","find","msg","params","undefined","onMounted","__exports__","render"],"sourceRoot":""}